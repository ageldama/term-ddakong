* ddakong / Plugin APIs

  | DLL API                                | Lua API          |
  |----------------------------------------+------------------|
  | =get_plugin_funcs=                     | N/A [fn:1]       |
  | =get_plugin_funcs_len=                 | N/A [fn:1]       |
  |----------------------------------------+------------------|
  | =get_current_handle_input_fn=          | (동일)           |
  | =set_current_handle_input_fn=          | (동일)           |
  |----------------------------------------+------------------|
  | =get_current_handle_input_status=      | N/A [fn:2]       |
  | =set_current_handle_input_status=      | N/A [fn:2]       |
  |----------------------------------------+------------------|
  | =hangeul2_im_handler_status_empty=     | N/A [fn:2]       |
  | =hangeul2_handle_stdin=                | N/A [fn:2]       |
  | =get_current_hangeul_automata_status=  | N/A [fn:2]       |
  |----------------------------------------+------------------|
  | =ERR_err_p=                            | (동일)           |
  | =ERR_clear=                            | (동일)           |
  | =ERR_set=                              | (동일)           |
  | =ERR_set_nofree=                       | N/A              |
  | =ERR_dieif=                            | (동일)           |
  | =ERR_warn_and_clear_if=                | (동일)           |
  | N/A [fn:3]                             | =ERR_get_errmsg= |
  |----------------------------------------+------------------|
  | =cp_fd=                                | (동일)           |
  | =fcntl_nb=                             | (동일)           |
  |----------------------------------------+------------------|
  | =print_banner=                         | (동일)           |
  | =get_verbose_flag=                     | (동일)           |
  | =set_verbose_flag=                     | (동일)           |
  | =get_keylog_filename=                  | (동일)           |
  | =get_default_keylog_filename=          | (동일)           |
  | =get_plugin_dll_filename=              | (동일)           |
  | =get_child_pid=                        | (동일)           |
  | =get_child_fd=                         | (동일)           |
  | =winsz_update=                         | (동일)           |
  | =unicode_to_utf8=                      | (동일)           |
  | =termios__init=                        | (동일)           |
  | =termios__reset=                       | (동일)           |
  | =signal_trap_norecover=                | (동일)           |
  | =forkpty_with_exec=                    | (동일)           |
  | =kill_forkpty=                         | (동일)           |
  | N/A [fn:4]                             | =fdread=         |
  | N/A [fn:4]                             | =fdwrite=        |
  |----------------------------------------+------------------|
  | =hangeul_const_chojungjong_nul=        | N/A [fn:2]       |
  | =hangeul_const_choseong=               | N/A [fn:2]       |
  | =hangeul_const_jungseong=              | N/A [fn:2]       |
  | =hangeul_const_jongseong=              | N/A [fn:2]       |
  | =hangeul_const_moeum=                  | N/A [fn:2]       |
  | =hangeul_const_jaeum=                  | N/A [fn:2]       |
  |----------------------------------------+------------------|
  | =hangeul_automata_status__new=         | N/A [fn:2]       |
  | =hangeul_automata_status__delete=      | N/A [fn:2]       |
  | =hangeul_automata_status__get_stage=   | N/A [fn:2]       |
  | =hangeul_automata_status__set_stage=   | N/A [fn:2]       |
  | =hangeul_automata_status__get_prev_ch= | N/A [fn:2]       |
  | =hangeul_automata_status__set_prev_ch= | N/A [fn:2]       |
  | =hangeul_automata_status__get_cho=     | N/A [fn:2]       |
  | =hangeul_automata_status__set_cho=     | N/A [fn:2]       |
  | =hangeul_automata_status__get_jung=    | N/A [fn:2]       |
  | =hangeul_automata_status__set_jung=    | N/A [fn:2]       |
  | =hangeul_automata_status__get_jong=    | N/A [fn:2]       |
  | =hangeul_automata_status__set_jong=    | N/A [fn:2]       |
  |----------------------------------------+------------------|
  | =hangeul_clear_automata_status=        | N/A [fn:2]       |
  | =hangeul_flush_automata_status=        | N/A [fn:2]       |
  |----------------------------------------+------------------|
  | =hangeul_auto_compose_to_unicode=      | N/A [fn:2]       |
  | =hangeul_full_compose_to_unicode=      | N/A [fn:2]       |
  | =hangeul_jamo_compose_to_unicode=      | N/A [fn:2]       |
  | =hangeul_jamo_jaeum_to_unicode=        | N/A [fn:2]       |
  | =hangeul_partial_jamo_p=               | N/A [fn:2]       |
  | =hangeul_empty_automata_status_p=      | N/A [fn:2]       |
  | =hangeul_2beol_alpha_as_jamoeum=       | N/A [fn:2]       |
  | =hangeul_2beol_fill=                   | N/A [fn:2]       |
  | =hangeul_2beol_find_code=              | N/A [fn:2]       |
  | =hangeul_double_jaeum=                 | N/A [fn:2]       |
  | =hangeul_put_unicode=                  | N/A [fn:2]       |
  | =hangeul_decompose_jongseong=          | N/A [fn:2]       |
  | =hangeul_2beol_commit_1_and_flush=     | N/A [fn:2]       |
  | =hangeul_put_jamo_unicode=             | N/A [fn:2]       |
  | =hangeul_remap_code=                   | N/A [fn:2]       |



* DLL Entry: =ddakong_plugin_entry=

  PLUGIN DLL에서 찾아 실행할 ddakong_plugin_entry() 함수의 타입

  - 반드시 이 함수를 구현/노출하여 ddakong와 플러그인을 연결합니다.
  - 최초에 플러그인이 사용할 수 있는 함수포인터의 목록을 전달 받는 역할.


#+begin_src c
typedef void (*ddakong_plugin_entry_fn_t)
(const plugin_func_t *funcs, const ssize_t funcs_len);
#+end_src


* DLL Exit: =ddakong_plugin_deinit=
 PLUGIN DLL에서 deinitialization시 호출할 함수의 타입

 - 해제할 자원이 있는 경우, 이 함수를 구현/노출하여 플러그인의
   deinitialization을 수행합니다.


 #+begin_src c
typedef void (*ddakong_plugin_deinit_fn_t)();
 #+end_src


* API =get_plugin_funcs=

  - ddakong이 노출하는 플러그인이 호출할 수 있는 함수포인터의 목록.

  #+begin_src c
    plugin_func_t *get_plugin_funcs(void)
  #+end_src

* API =get_plugin_funcs=

  - ddakong이 노출하는 플러그인이 호출할 수 있는 함수포인터의 목록의 길이.

  #+begin_src c
    ssize_t get_plugin_funcs_len(void);
  #+end_src


* C TYPE =plugin_func_t=
  로딩한 DLL 파일의 * ddakong_plugin_entry() 함수에 전달할 함수포인터
  배열의 행타입.

  - @field =p_func= 함수포인터
  - @field =sz_func_name= 함수의 이름 (예: "printf")
  - @field =sz_func_doc= 함수설명 (예: "prints somethign")

#+begin_src c
typedef struct {
  void *p_func;
  char *sz_func_name;
  char *sz_func_doc;
} plugin_func_t;
#+end_src


* Footnotes
[fn:4] 루아에는 없는 Unix file-descriptor read/write 지원.

[fn:3] 루아는 C구조체 필드에 접근할 수 없으므로 지원.
[fn:2] 루아 스크립팅은 내장 한글입력기 연동 지원 않음.

[fn:1] ~ddakong~ lua module이 어차피 모든 API함수들을 노출하고
있으므로 불필요.
